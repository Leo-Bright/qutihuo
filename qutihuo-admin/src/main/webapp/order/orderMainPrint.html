<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Dashboard</title>

    <meta name="description" content="Dashboard" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="/assets/img/favicon.png" type="image/x-icon">
    <script src="/assets/js/Lodop.js"></script>
    <#include "/common/header.html">
   
</head>

<body>
    <!-- Navbar -->
    <#include "/common/navbar.html">
    <!-- /Navbar -->
    
    <!-- Main Container -->
    <div class="main-container container-fluid">
        <!-- Page Container -->
        <div class="page-container">
            <!-- Page Sidebar -->
            <#include "/common/menu.html">
            <!-- /Page Sidebar -->
            
            <!-- Page Content -->
            <div class="page-content">
            
                <!-- Page Breadcrumb -->
                <div class="page-breadcrumbs">
                    <ul class="breadcrumb">
                        <li>
                            <i class="fa fa-home"></i> 
                            <a href="#">订单管理</a>
                        </li>
                        <li><a href="/orderMain/orderMainList.jhtml">订单列表</a></li>
                        <li>订单打印</li>
                    </ul>
                </div>
                <!-- /Page Breadcrumb -->
                
                <div class="page-body">
                    <div class="row">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                        <div class="col-xs-12 col-md-12">
                            <div class="well with-header with-footer">
                                <div class="header">
                                	<i class="glyphicon glyphicon-edit"></i>&nbsp;<b>选择物流公司</b>
                                </div>
                            
								<form id="html5Form"  class="form-horizontal"  >
									<input type="hidden" name="id" value="${(orderMain.id)!''}" id="orderId"/>
                                    <div class="form-group">
                                    	<label class="col-lg-2 control-label">物流公司</label>
                                        <div class="col-lg-4">
                                           <select class="form-control" id ="lcCode" name="lcCode">
                                            <#list lcList as item >
											  <option value="${item.lcCode}">${item.lcName}</option>
											  </#list>
											</select>
                                        </div>
                                        <div class="col-lg-4"><p class="help-block">物流公司信息</p></div>
                                    </div>
                                    
                                    
									<div class="form-group" data-topic="iconCss">
                                        <label class="col-lg-2 control-label">快递单号</label>
                                        <div class="col-lg-4">
                                            <input type="text" class="form-control" id ="expressOrderNo" name="expressOrderNo"/>
                                        </div>
                                        <div class="col-lg-4"><p class="help-block">快递单号</p></div>
                                    </div>

                                   
                                    
                                    
                                    <div class="form-group">
                                        <div class="col-lg-2 col-lg-offset-2">
                                        	 <button  id="printBtn" class="btn btn-success">打印</button>
                                        	 <button id="printReviewBtn" class="btn btn-success">打印预览</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
        
                        </div>
                    </div>
                </div>
            </div>
            <!-- /Page Content -->
        </div>
        <!-- /Page Container -->
        <!-- Main Container -->
    </div>

   
<script>
     var LODOP; //声明为全局变量
	 $('#printBtn').on('click', function () {
		 var lcCode = $("#lcCode").val();
		 var expressOrderNo = $("#expressOrderNo").val();
		 var id = $("#orderId").val();
		 if($("#lcCode").val()==""&&$("#lcCode").val()==""){
			 Notify('物流公司为空！', 'bottom-right', '1500', 'success', 'fa-check', true);
		}else if($("#expressOrderNo").val()==""&&$("#expressOrderNo").val()==""){
			Notify('快递单号为空！', 'bottom-right', '1500', 'success', 'fa-check', true);
		}else{
			var dataParam={"lcCode":lcCode,"expressOrderNo":expressOrderNo,"id":id};
			$.post('/orderMain/printOrder.jhtml', dataParam, function(result) {
                if(result.state.code==200){
                	LODOP=getLodop();
	             	if(LODOP==null){
	             		return;
	             	}
	             	//LODOP.NewPage();
        			eval(result.data.lc.expressTemplate);
        			LODOP.SET_SHOW_MODE("BKIMG_PRINT",0);
        			LODOP.SET_SHOW_MODE("LANDSCAPE_DEFROTATED",1);//纵向打印时显示正面朝上
					//LODOP.PRINT_DESIGN();
					LODOP.PRINT();//预览
        			//LODOP.PRINT();
	        	}else{
	        		Notify('操作失败!', 'bottom-right', '1500', 'danger', 'fa-bolt', true); 
	        	}
            }, 'json');
		}

	 });	 

	 $('#printReviewBtn').on('click', function () {
		 var lcCode = $("#lcCode").val();
		 var expressOrderNo = $("#expressOrderNo").val();
		 var id = $("#orderId").val();
		 if($("#lcCode").val()==""&&$("#lcCode").val()==""){
			 Notify('物流公司为空！', 'bottom-right', '1500', 'success', 'fa-check', true);
		}else if($("#expressOrderNo").val()==""&&$("#expressOrderNo").val()==""){
			Notify('快递单号为空！', 'bottom-right', '1500', 'success', 'fa-check', true);
		}else{
			var dataParam={"lcCode":lcCode,"expressOrderNo":expressOrderNo,"id":id};
			$.post('/orderMain/printOrder.jhtml', '', function(result) {
				
                if(result.state.code==200){
                	LODOP=getLodop();
	             	if(LODOP==null){
	             		return;
	             	}
	             	eval(result.data.lc.expressTemplate);
        			LODOP.SET_SHOW_MODE("BKIMG_PRINT",0);
        			LODOP.SET_SHOW_MODE("LANDSCAPE_DEFROTATED",1);//纵向打印时显示正面朝上
        			LODOP.PREVIEW();
        			//LODOP.PRINT();
	        	}else{
	        		Notify('操作失败!', 'bottom-right', '1500', 'danger', 'fa-bolt', true); 
	        	}
            }, 'json');
		}

	 });
	 
	 
</script>
</body>
</html>
