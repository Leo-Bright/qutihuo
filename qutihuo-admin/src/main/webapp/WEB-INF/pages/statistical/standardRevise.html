<@override name="page-content">  
    <div class="page-breadcrumbs">
        <ul class="breadcrumb">
            <li><i class="fa fa-home"></i><a href="#">标准化能力</a></li>
            <li>标准修订</li>
        </ul>
    </div>
    
    <div class="page-body">
        <div class="row">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            <div class="col-xs-12 col-md-12">
                <div class="well with-header with-footer" id="echartShow">
                    <div id="nationproduct_main_1" style="display: block">
                        <div id="nationproduct_1" style="width: 100%; height: 730px;">
                        </div>
                        <div id="nationproduct_foot_1">
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    
    <form id="html5Form" class="form-horizontal" role="form" method="POST" style="display: none;" action="/system/editPwd.jhtml">
    	<input type="hidden" name="id"/>
        <div class="form-group">
            <label class="col-sm-3 control-label">登陆账号</label>
            <div class="col-sm-7">
                <input type="text" class="form-control" name="loginName" disabled>
            </div>
        </div>
        
        <div class="form-group">
            <label class="col-sm-3 control-label">新密码<font color="red"> *</font></label>
            <div class="col-sm-7">
                <input type="password" class="form-control" name="passwd">
            </div>
        </div>
        
        <div class="form-group">
            <label class="col-sm-3 control-label">确认新密码<font color="red"> *</font></label>
            <div class="col-sm-7">
                <input type="password" class="form-control" name="comfirmPasswd">
            </div>
        </div>
        
        <div class="form-group">
	        <div class="col-xs-5 col-xs-offset-3">
            	<button type="submit" class="btn btn-success">确认</button>
	        </div>
	    </div>
    </form>
</@override>
<@override name="custom-script">
<script type="text/javascript" src="/assets/Scripts/echarts.js"></script>
<script type="text/javascript" src="/assets/Scripts/china.js"></script>
<script type="text/javascript" src="/assets/Scripts/standardization.js"></script>
    <script>
    	$(document).ready(function() {
            var checkedArray =[];
            var jsonMap = ${jsonMap};
            var _2016 = jsonMap.year_2016;
            console.log(_2016)

            var sample_chart = echarts.init(document.getElementById("nationproduct_1"));
            sample_chart.setOption(std_zxd_option);
    		// 修改密码
	        $(".J_editPwd").on('click', function () {
	        	var formData = JSON.parse($(this).parent().parent().attr('data-formData'));
	        	bootbox.dialog({
	                title: '修改密码',
	                message: $('#html5Form'),
	                show: false
	            })
	            .on('shown.bs.modal', function() {
	            	$('#html5Form').show().formValidation('resetForm', true); 
	            	$("#html5Form").autofill(formData);
	            })
	            .on('hide.bs.modal', function(e) {
	            	$('#html5Form').hide().appendTo('body');
	            })
	            .modal('show');
	        });
	
			// 保存密码
	        $('#html5Form').formValidation({
				fields: {
					passwd: {
		                validators: {
		                    notEmpty: {
		                        message: '登陆密码不能为空'
		                    },
		                    stringLength: {
		                        min: 6,
		                        max: 16,
		                        message: '登陆密码长度必须在6-16个字符以内'
		                    }
		                }
		            },
		            comfirmPasswd: {
		                validators: {
		                    identical: {
		                    	field: 'passwd',
		                        message: '确认登陆密码不一致'
		                    }
		                }
		            }
		        }
			})        
			.on('success.form.fv', function(e) {
	            // Prevent form submission
	            e.preventDefault();
	
	            // Get the form instance
	            var $form = $(e.target);
	
	            // Get the FormValidation instance
	            var bv = $form.data('formValidation');
	
	            // Use Ajax to submit form data
	             $.post($form.attr('action'), $form.serialize(), function(result) {
	                if(result.state.code==200){
		        		Notify('操作成功', 'bottom-right', '1500', 'success', 'fa-check', true);
		        		setTimeout(function () {location.reload();}, 1500);
		        	}else{
		        		Notify(result.state.msg, 'bottom-right', '1500', 'danger', 'fa-bolt', true); 
		        	}
	            }, 'json');
	        });
			
			// 锁定用户
	        $(".J_lockUser").on('click', function () {
	        	var dataParam = $(this).attr('data-param');
	        	bootbox.confirm({
			        message: '锁定用户后该用户将无法登陆!<br/><br/>你确定锁定该用户？',
			        title: "提示",
			        callback: function(result) {  
			            if (result) {
		                    $.post('/system/lockUser.jhtml', JSON.parse(dataParam), function(result) {
				                if(result.state.code==200){
					        		Notify('操作成功', 'bottom-right', '1500', 'success', 'fa-check', true);
					        		setTimeout(function () {location.reload();}, 1500);
					        	}else{
					        		Notify(result.state.msg, 'bottom-right', '1500', 'danger', 'fa-bolt', true); 
					        	}
				            }, 'json');
		                }
			        }
		        });
		    });
		    
		    		
			// 解锁用户
	        $(".J_unlockUser").on('click', function () {
	        	var dataParam = $(this).attr('data-param');
	        	bootbox.confirm({
			        message: '你确定解锁该用户？',
			        title: "提示",
			        callback: function(result) {  
			            if (result) {
		                    $.post('/system/unlockUser.jhtml', JSON.parse(dataParam), function(result) {
				                if(result.state.code==200){
					        		Notify('操作成功!', 'bottom-right', '1500', 'success', 'fa-check', true);
					        		setTimeout(function () {location.reload();}, 1500);
					        	}else{
					        		Notify(result.state.msg, 'bottom-right', '1500', 'danger', 'fa-bolt', true); 
					        	}
				            }, 'json');
		                }
			        }
		        });
		    });
    	});

    </script>
</@override>
<@extends name="/common/base.html"/>
